{% extends 'nichiei/layouts/base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% load humanize %}

{% block headerscript %}

{% endblock headerscript%}
{% block content %}


    <section id="page-title">

        <div class="container clearfix">
            <h1>Checkout</h1>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item"><a href="#">Shop</a></li>
                <li class="breadcrumb-item active" aria-current="page">Checkout</li>
            </ol>
        </div>

    </section>

    <section id="content">
        <div class="content-wrap">
            <div class="container clearfix">

                <div class="row col-mb-50 gutter-50">
                    <div class="col-lg-12">

                    {% include "partials/_messages.html" %}
                    </div>
                </div>
                <div class="row col-mb-50 gutter-50">
                    {% if session_cart.count %}
                        <div class="col-lg-6">
                            <h3>Shipping Address</h3>
                            <form id="shipping-form" name="shipping-form" class="row mb-0"
                                  action="{% url 'store:checkout' %}" method="post">
                                {% csrf_token %}
                                <div class="w-100"></div>

                                <div class="col-md-6 form-group">
                                    <label for="shipping-form-name">Name:</label>
                                    {{ form.name }}
                                </div>

                                <div class="w-100"></div>

                                <div class="col-md-6 form-group">
                                    <label for="shipping-form-lname">Phone:</label>
                                    {{ form.phone }}
                                </div>

                                <div class="w-100"></div>

                                <div class="col-md-6 form-group">
                                    <label for="shipping-form-lname">Email:</label>
                                    {{ form.email }}
                                </div>

                                <div class="w-100"></div>

                                <div class="col-6 form-group">
                                    <label for="shipping-form-lname">Postcode:</label>
                                    {{ form.postcode }}
                                </div>


                                <div class="col-6 form-group">
                                    <label for="shipping-form-companyname">State:</label>
                                    {{ form.state }}
                                </div>

                                <div class="w-100"></div>

                                <div class="col-6 form-group">
                                    <label for="shipping-form-address">Town:</label>
                                    {{ form.town }}
                                </div>


                                <div class="col-6 form-group">
                                    <label for="shipping-form-address">Street:</label>
                                    {{ form.street }}
                                </div>

                                <div class="w-100"></div>
                                <div class="col-12 form-group">
                                    <label for="shipping-form-city">Address Details:</label>
                                    {{ form.address_1 }}
                                </div>
                                <div class="col-12 form-group">
                                    {{ form.address_2 }}
                                </div>

                                <div class="col-12 form-group">
                                    <label for="shipping-form-message">Notes <small>*</small></label>
                                    <textarea class="sm-form-control" id="shipping-form-message"
                                              name="shipping-form-message" rows="6" cols="30"></textarea>
                                </div>

                                <div class="col-12 form-group">

                                    <button class="button button-3d float-right" type="submit">Place Order</button>
                                </div>

                            </form>
                        </div>
                        <div class="col-lg-6">
                            <h4>Your Orders</h4>
                            <div class="table-responsive">
                                <table class="table cart">
                                    <thead>
                                    <tr>
                                        <th class="cart-product-thumbnail">&nbsp;</th>
                                        <th class="cart-product-name">Product</th>
                                        <th class="cart-product-quantity">Quantity</th>
                                        <th class="cart-product-subtotal">Total</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for orderitem in session_cart.items %}
                                        <tr class="cart_item">
                                            <td class="cart-product-thumbnail">
                                                <a href="#"><img width="64" height="64"
                                                                 src="{{ orderitem.product.thumbimage.url }}"
                                                                 alt="Pink Printed Dress"></a>
                                            </td>

                                            <td class="cart-product-name">
                                                <a href="#">{{ orderitem.product.item_name }}</a>
                                            </td>

                                            <td class="cart-product-quantity">
                                                <div class="quantity clearfix">
                                                    1x{{ orderitem.quantity }}
                                                </div>
                                            </td>

                                            <td class="cart-product-subtotal">
                                                <span class="amount">¥{{ orderitem.subtotal |intcomma:False}}</span>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>

                            <h4>Cart Totals</h4>

                            <div class="table-responsive">
                                <table class="table cart">
                                    <tbody>
                                    <tr class="cart_item">
                                        <td class="cart-product-name">
                                            <strong>Total</strong>
                                        </td>

                                        <td class="cart-product-name">
                                            <span class="amount color lead"><strong>¥{{ session_cart.total |intcomma:False}}</strong></span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            {#                        <a href="#" class="button button-3d float-right">Place Order</a>#}
                        </div>
                    {% else %}
                        <div class="col-lg-12">
                            <div class="promo promo-border text-center p-4 p-md-5 mb-5">
                                <div class="row align-items-center">
                                    <div class="col-12">
                                        <h3>You have <span class="text-danger">no</span> cart to checkout</h3>
                                        <span>Try to put something to your shopping Cart!</span>
                                    </div>
                                    <div class="col-12 mt-4">
                                        <a href="{% url 'store:home' %}" class="btn btn-lg btn-danger">Start Shopping!</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

{% endblock content%}

{% block footerscript_last %}
    <script src="{% static 'js/postcode_auto.js' %}"></script>

{% endblock footerscript_last%}